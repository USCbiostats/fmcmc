<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Markov Chain Monte Carlo — MCMC • fmcmc</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Markov Chain Monte Carlo — MCMC" />

<meta property="og:description" content="A flexible implementation of the Metropolis-Hastings MCMC algorithm." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fmcmc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/fmcmc-a-flexible-mcmc-estimation-framework.html">Workflow with the MCMC function</a>
    </li>
    <li>
      <a href="../articles/integer-kernel.html">Personalized kernel functions</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/USCbiostats/fmcmc">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Markov Chain Monte Carlo</h1>
    <small class="dont-index">Source: <a href='https://github.com/USCbiostats/fmcmc/blob/master/R/mcmc.r'><code>R/mcmc.r</code></a></small>
    <div class="hidden name"><code>MCMC.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>A flexible implementation of the Metropolis-Hastings MCMC algorithm.</p>
    
    </div>

    <pre class="usage"><span class='fu'>MCMC</span>(<span class='no'>initial</span>, <span class='no'>fun</span>, <span class='no'>nsteps</span>, <span class='no'>...</span>, <span class='kw'>nchains</span> <span class='kw'>=</span> <span class='fl'>1L</span>, <span class='kw'>burnin</span> <span class='kw'>=</span> <span class='fl'>0L</span>, <span class='kw'>thin</span> <span class='kw'>=</span> <span class='fl'>1L</span>,
  <span class='kw'>kernel</span> <span class='kw'>=</span> <span class='fu'><a href='kernels.html'>kernel_normal</a></span>(), <span class='kw'>multicore</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>conv_checker</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>cl</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='co'># S3 method for mcmc</span>
<span class='fu'>MCMC</span>(<span class='no'>initial</span>, <span class='no'>fun</span>, <span class='no'>nsteps</span>, <span class='no'>...</span>, <span class='kw'>nchains</span> <span class='kw'>=</span> <span class='fl'>1L</span>,
  <span class='kw'>burnin</span> <span class='kw'>=</span> <span class='fl'>0L</span>, <span class='kw'>thin</span> <span class='kw'>=</span> <span class='fl'>1L</span>, <span class='kw'>kernel</span> <span class='kw'>=</span> <span class='fu'><a href='kernels.html'>kernel_normal</a></span>(),
  <span class='kw'>multicore</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>conv_checker</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>cl</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='co'># S3 method for mcmc.list</span>
<span class='fu'>MCMC</span>(<span class='no'>initial</span>, <span class='no'>fun</span>, <span class='no'>nsteps</span>, <span class='no'>...</span>, <span class='kw'>nchains</span> <span class='kw'>=</span> <span class='fl'>1L</span>,
  <span class='kw'>burnin</span> <span class='kw'>=</span> <span class='fl'>0L</span>, <span class='kw'>thin</span> <span class='kw'>=</span> <span class='fl'>1L</span>, <span class='kw'>kernel</span> <span class='kw'>=</span> <span class='fu'><a href='kernels.html'>kernel_normal</a></span>(),
  <span class='kw'>multicore</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>conv_checker</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>cl</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>MCMC</span>(<span class='no'>initial</span>, <span class='no'>fun</span>, <span class='no'>nsteps</span>, <span class='no'>...</span>, <span class='kw'>nchains</span> <span class='kw'>=</span> <span class='fl'>1L</span>,
  <span class='kw'>burnin</span> <span class='kw'>=</span> <span class='fl'>0L</span>, <span class='kw'>thin</span> <span class='kw'>=</span> <span class='fl'>1L</span>, <span class='kw'>kernel</span> <span class='kw'>=</span> <span class='fu'><a href='kernels.html'>kernel_normal</a></span>(),
  <span class='kw'>multicore</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>conv_checker</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>cl</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>initial</th>
      <td><p>Either a numeric matrix or vector, or an object of class <a href='https://rdrr.io/pkg/coda/man/mcmc.html'>coda::mcmc</a>
or <a href='https://rdrr.io/pkg/coda/man/mcmc.list.html'>coda::mcmc.list</a> (see details).
initial values of the parameters for each chain (See details).</p></td>
    </tr>
    <tr>
      <th>fun</th>
      <td><p>A function. Returns the log-likelihood.</p></td>
    </tr>
    <tr>
      <th>nsteps</th>
      <td><p>Integer scalar. Length of each chain.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments passed to <code>fun</code>.</p></td>
    </tr>
    <tr>
      <th>nchains</th>
      <td><p>Integer scalar. Number of chains to run (in parallel).</p></td>
    </tr>
    <tr>
      <th>burnin</th>
      <td><p>Integer scalar. Length of burn-in. Passed to
<a href='https://rdrr.io/pkg/coda/man/mcmc.html'>coda::mcmc</a> as <code>start</code>.</p></td>
    </tr>
    <tr>
      <th>thin</th>
      <td><p>Integer scalar. Passed to <a href='https://rdrr.io/pkg/coda/man/mcmc.html'>coda::mcmc</a>.</p></td>
    </tr>
    <tr>
      <th>kernel</th>
      <td><p>An object of class <a href='kernels.html'>fmcmc_kernel</a>.</p></td>
    </tr>
    <tr>
      <th>multicore</th>
      <td><p>Logical. If <code>FALSE</code> then chains will be executed in serial.</p></td>
    </tr>
    <tr>
      <th>conv_checker</th>
      <td><p>A function that receives an object of class <a href='https://rdrr.io/pkg/coda/man/mcmc.list.html'>coda::mcmc.list</a>,
and returns a logical value with <code>TRUE</code> indicating convergence.</p></td>
    </tr>
    <tr>
      <th>cl</th>
      <td><p>A <code>cluster</code> object passed to <a href='https://rdrr.io/r/parallel/clusterApply.html'>parallel::clusterApply</a>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <a href='https://rdrr.io/pkg/coda/man/mcmc.html'>coda::mcmc</a> from the <a href='https://CRAN.R-project.org/package=coda'><span class="pkg">coda</span></a>
package. The <code>mcmc</code> object is a matrix with one column per parameter,
and <code>nsteps</code> rows. If <code>nchains &gt; 1</code>, then it returns a <a href='https://rdrr.io/pkg/coda/man/mcmc.list.html'>coda::mcmc.list</a>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function implements MCMC using the Metropolis-Hastings ratio with
flexible transition kernels. Users can specify either one of the available
transition kernels or define one of their own (see <a href='kernels.html'>kernels</a>). Furthermore,
it allows easy parallel implementation running multiple chains in parallel. In
addition, we incorporate a variety of convergence diagnostics, alternatively
the user can specify their own (see <a href='convergence-checker.html'>convergence-checker</a>).</p>
<p>We now give details of the various options included in the function.</p>
    
    <h2 class="hasAnchor" id="starting-point"><a class="anchor" href="#starting-point"></a>Starting point</h2>

    
    <p>By default, if <code>initial</code> is of class <code>mcmc</code>, <code>MCMC</code> will take the last <code>nchains</code>
points from the chain as starting point for the new sequence. If <code>initial</code> is
of class <code>mcmc.list</code>, the number of chains in <code>initial</code> must match the <code>nchains</code>
parameter.</p>
<p>If <code>initial</code> is a vector, then it must be of length equal to the number of
parameters used in the model. When using multiple chains, if <code>initial</code> is not
an object of class <code>mcmc</code> or <code>mcmc.list</code>, then it must be a numeric matrix
with as many rows as chains, and as many columns as parameters in the model.</p>
    
    <h2 class="hasAnchor" id="multiple-chains"><a class="anchor" href="#multiple-chains"></a>Multiple chains</h2>

    
    <p>When <code>nchains &gt; 1</code>, the function will run multiple chains. Furthermore,
if <code>cl</code> is not passed, <code>MCMC</code> will create a <code>PSOCK</code> cluster
using <a href='https://rdrr.io/r/parallel/makeCluster.html'>parallel::makePSOCKcluster</a> with
<a href='https://rdrr.io/r/parallel/detectCores.html'>parallel::detectCores</a>
clusters and attempt to execute using multiple cores. Internally, the function does
the following:</p>
<pre>
  # Creating the cluster
  ncores &lt;- parallel::detectCores()
  ncores &lt;- ifelse(nchains &lt; ncores, nchains, ncores)
  cl     &lt;- parallel::makePSOCKcluster(ncores)
    # Loading the package and setting the seed using clusterRNGStream
  invisible(parallel::clusterEvalQ(cl, library(fmcmc)))
  parallel::clusterSetRNGStream(cl, .Random.seed)
</pre>
    <p>When running in parallel, objects that are
used within <code>fun</code> must be passed through <code>...</code>, otherwise the cluster
will return with an error.</p>
<p>The user controls the initial value of the parameters of the MCMC algorithm
using the argument <code>initial</code>. When using multiple chains, i.e., <code>nchains &gt; 1</code>,
the user can specify multiple starting points, which is recommended. In such a
case, each row of <code>initial</code> is use as a starting point for each of the
chains. If <code>initial</code> is a vector and <code>nchains &gt; 1</code>, the value is recycled, so
all chains start from the same point (not recommended, the function throws a
warning message).</p>
    
    <h2 class="hasAnchor" id="automatic-stop"><a class="anchor" href="#automatic-stop"></a>Automatic stop</h2>

    
    <p>By default, no automatic stop is implemented. If one of the functions in
<a href='convergence-checker.html'>convergence-checker</a> is used, then the MCMC is done by bulks as specified
by the convergence checker function, and thus the algorithm will stop if,
the <code>conv_checker</code> returns <code>TRUE</code>. For more information see <a href='convergence-checker.html'>convergence-checker</a>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Univariate distributed data with multiple parameters ----------------------</span>
<span class='co'># Parameters</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1231</span>)
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>1e3</span>
<span class='no'>pars</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>2.6</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>3</span>)

<span class='co'># Generating data and writing the log likelihood function</span>
<span class='no'>D</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n</span>, <span class='no'>pars</span>[<span class='fl'>1</span>], <span class='no'>pars</span>[<span class='fl'>2</span>])
<span class='no'>fun</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) {
  <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>dnorm</a></span>(<span class='no'>D</span>, <span class='no'>x</span>[<span class='fl'>1</span>], <span class='no'>x</span>[<span class='fl'>2</span>]))
  <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>x</span>)
}

<span class='co'># Calling MCMC, but first, loading the coda R package for</span>
<span class='co'># diagnostics</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>coda</span>)
<span class='no'>ans</span> <span class='kw'>&lt;-</span> <span class='fu'>MCMC</span>(
  <span class='no'>fun</span>, <span class='kw'>initial</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>mu</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>sigma</span><span class='kw'>=</span><span class='fl'>1</span>), <span class='kw'>nsteps</span> <span class='kw'>=</span> <span class='fl'>2e3</span>,
  <span class='kw'>kernel</span> <span class='kw'>=</span> <span class='fu'><a href='kernels.html'>kernel_reflective</a></span>(<span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>.1</span>, <span class='kw'>ub</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>lb</span> <span class='kw'>=</span> <span class='fl'>0</span>)
  )

<span class='co'># Ploting the output</span>
<span class='no'>oldpar</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>no.readonly</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>ans</span>),
        <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span>(<span class='st'>"Posterior distribution of"</span>~<span class='no'>mu</span>~<span class='no'>and</span>~<span class='no'>sigma</span>),
        <span class='kw'>names</span> <span class='kw'>=</span>  <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span>(<span class='no'>mu</span>, <span class='no'>sigma</span>), <span class='kw'>horizontal</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
        <span class='kw'>col</span>  <span class='kw'>=</span> <span class='no'>blues9</span>[<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4</span>,<span class='fl'>9</span>)],
        <span class='kw'>sub</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/bquote.html'>bquote</a></span>(<span class='no'>mu</span> <span class='kw'>==</span> <span class='fu'>.</span>(<span class='no'>pars</span>[<span class='fl'>1</span>])~<span class='st'>", and"</span>~<span class='no'>sigma</span> <span class='kw'>==</span> <span class='fu'>.</span>(<span class='no'>pars</span>[<span class='fl'>2</span>]))
)
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span>(<span class='kw'>v</span> <span class='kw'>=</span> <span class='no'>pars</span>, <span class='kw'>col</span>  <span class='kw'>=</span> <span class='no'>blues9</span>[<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4</span>,<span class='fl'>9</span>)], <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fl'>2</span>)

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>ans</span>), <span class='fl'>1</span>, <span class='no'>fun</span>), <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"l"</span>,
     <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"LogLikelihood"</span>,
     <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span>(<span class='fu'>L</span>(<span class='st'>"{"</span>~<span class='no'>mu</span>,<span class='no'>sigma</span>~<span class='st'>"}"</span>~<span class='st'>"|"</span>~<span class='no'>D</span>))
)</div><div class='img'><img src='MCMC-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='no'>oldpar</span>)</div># NOT RUN {
# In this example we estimate the parameter for a dataset with ----------------
# With 5,000 draws from a MVN() with parameters M and S.

# Loading the required packages
library(mvtnorm)
library(coda)

# Parameters and data simulation
S <- cbind(c(.8, .2), c(.2, 1))
M <- c(0, 1)

set.seed(123)
D <- rmvnorm(5e3, mean = M, sigma = S)

# Function to pass to MCMC
fun <- function(pars) {
  # Putting the parameters in a sensible way
  m <- pars[1:2]
  s <- cbind( c(pars[3], pars[4]), c(pars[4], pars[5]) )
  
  # Computing the unnormalized log likelihood
  sum(log(dmvnorm(D, m, s)))
}

# Calling MCMC
ans <- MCMC(
  initial = c(mu0=5, mu1=5, s0=5, s01=0, s2=5), 
  fun,
  kernel  = kernel_reflective(
    lb    = c(-10, -10, .01, -5, .01),
    ub    = 5
    scale = 0.01
  ),
  nsteps  = 1e5,
  thin    = 20,
  burnin  = 5e3
)

# Checking out the outcomes
plot(ans)
summary(ans)

# Multiple chains -----------------------------------------------------------

# As we want to run -fun- in multiple cores, we have to
# pass -D- explicitly (unless using Fork Clusters)
# just like specifying that we are calling a function from the
# -mvtnorm- package.
  
fun <- function(pars, D) {
  # Putting the parameters in a sensible way
  m <- pars[1:2]
  s <- cbind( c(pars[3], pars[4]), c(pars[4], pars[5]) )
  
  # Computing the unnormalized log likelihood
  sum(log(mvtnorm::dmvnorm(D, m, s)))
}

# Two chains
ans <- MCMC(
  initial = c(mu0=5, mu1=5, s0=5, s01=0, s2=5), 
  fun,
  nchains = 2,
  kernel  = kernel_reflective(
    lb    = c(-10, -10, .01, -5, .01),
    ub    = 5
    scale = 0.01
  ),
  nsteps  = 1e5,
  thin    = 20,
  burnin  = 5e3,
  D       = D
)

summary(ans)
# }
<div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#starting-point">Starting point</a></li>

      <li><a href="#multiple-chains">Multiple chains</a></li>

      <li><a href="#automatic-stop">Automatic stop</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by George Vega Yon, National Cancer Institute (NCI).</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


