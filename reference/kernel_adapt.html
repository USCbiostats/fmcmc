<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Adaptive Metropolis (AM) Transition Kernel — kernel_adapt • fmcmc</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Adaptive Metropolis (AM) Transition Kernel — kernel_adapt"><meta property="og:description" content="Implementation of Haario et al. (2001)'s Adaptive Metropolis."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-108627422-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-108627422-3');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fmcmc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/advanced-features.html">Advanced features</a>
    </li>
    <li>
      <a href="../articles/user-defined-kernels.html">User-defined kernels</a>
    </li>
    <li>
      <a href="../articles/workflow-with-fmcmc.html">Workflow with fmcmc</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/USCbiostats/fmcmc/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Adaptive Metropolis (AM) Transition Kernel</h1>
    <small class="dont-index">Source: <a href="https://github.com/USCbiostats/fmcmc/blob/HEAD/R/kernel_adapt.R" class="external-link"><code>R/kernel_adapt.R</code></a></small>
    <div class="hidden name"><code>kernel_adapt.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Implementation of Haario et al. (2001)'s Adaptive Metropolis.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">kernel_adapt</span><span class="op">(</span>
  mu <span class="op">=</span> <span class="fl">0</span>,
  bw <span class="op">=</span> <span class="fl">0L</span>,
  lb <span class="op">=</span> <span class="op">-</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.xmax</span>,
  ub <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.xmax</span>,
  freq <span class="op">=</span> <span class="fl">1L</span>,
  warmup <span class="op">=</span> <span class="fl">500L</span>,
  Sigma <span class="op">=</span> <span class="cn">NULL</span>,
  Sd <span class="op">=</span> <span class="cn">NULL</span>,
  eps <span class="op">=</span> <span class="fl">1e-04</span>,
  fixed <span class="op">=</span> <span class="cn">FALSE</span>,
  until <span class="op">=</span> <span class="cn">Inf</span>
<span class="op">)</span>

<span class="fu">kernel_am</span><span class="op">(</span>
  mu <span class="op">=</span> <span class="fl">0</span>,
  bw <span class="op">=</span> <span class="fl">0L</span>,
  lb <span class="op">=</span> <span class="op">-</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.xmax</span>,
  ub <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.xmax</span>,
  freq <span class="op">=</span> <span class="fl">1L</span>,
  warmup <span class="op">=</span> <span class="fl">500L</span>,
  Sigma <span class="op">=</span> <span class="cn">NULL</span>,
  Sd <span class="op">=</span> <span class="cn">NULL</span>,
  eps <span class="op">=</span> <span class="fl">1e-04</span>,
  fixed <span class="op">=</span> <span class="cn">FALSE</span>,
  until <span class="op">=</span> <span class="cn">Inf</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mu</dt>
<dd><p>Either a numeric vector or a scalar. Proposal mean.
If scalar, values are recycled to match the number of parameters in the
objective function.</p></dd>
<dt>bw</dt>
<dd><p>Integer scalar. The bandwidth, is the number of observations to
include in the computation of the variance-covariance matrix.</p></dd>
<dt>lb, ub</dt>
<dd><p>Either a numeric vector or a scalar. Lower and upper bounds for
bounded kernels. When of length 1, the values are recycled to match the number
of parameters in the objective function.</p></dd>
<dt>freq</dt>
<dd><p>Integer scalar. Frequency of updates. How often the
variance-covariance matrix is updated. The implementation is different from that
described in the original paper (see details).</p></dd>
<dt>warmup</dt>
<dd><p>Integer scalar. The number of iterations that the algorithm has
to wait before starting to do the updates.</p></dd>
<dt>Sigma</dt>
<dd><p>The variance-covariance matrix. By default this will be an
identity matrix during the warmup period.</p></dd>
<dt>Sd</dt>
<dd><p>Overall scale for the algorithm. By default, the variance-covariance
is scaled to \(2.4^2/d\), with \(d\) the number of dimensions.</p></dd>
<dt>eps</dt>
<dd><p>Double scalar. Default size of the initial step (see details).</p></dd>
<dt>fixed</dt>
<dd><p>Logical scalar or vector of length <code>k</code>. Indicates which parameters
will be treated as fixed or not. Single values are recycled.</p></dd>
<dt>until</dt>
<dd><p>Integer scalar. Last step at which adaptation takes place (see
details).</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of class <a href="kernel_new.html">fmcmc_kernel</a>. <code>fmcmc_kernel</code> objects are intended
to be used with the <code><a href="MCMC.html">MCMC()</a></code> function.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>While it has been shown that under regular conditions this transition kernel
generates ergodic chains even when the adaptation does not stop, some
practitioners may want to stop adaptation at some point.</p>
<p><code>kernel_adapt</code> Implements the adaptive Metropolis (AM) algorithm of Haario
et al. (2001). If the value of bw is greater than zero, then the algorithm
folds back AP, a  previous version which is known to have ergodicity problems.</p>
<p>The parameter <code>eps</code> has two functions. The first one is to set the initial
scale for the multivariate normal kernel, which is replaced after <code>warmup</code>
steps with the actual variance-covariance computed by the main algorithm.
The second usage is in the equation that ensures that the variance-covariance
is greater than zero, this is, the \(\varepsilon\) parameter in the
original paper.</p>
<p>The update of the covariance matrix is done using <code><a href="cov_recursive.html">cov_recursive()</a></code> function,
which makes the updates faster. The <code>freq</code> parameter, besides of indicating the
frequency with which the updates are done, it specifies what are the samples
included in each update, in other words, like a thinning parameter, only every
<code>freq</code> samples will be used to compute the covariance matrix. Since this
implementation uses the recursive formula for updating the covariance, there is
no practical need to set <code>freq != 1</code>.</p>
<p><code>kernel_am</code> is just an alias for <code>kernel_adapt</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Haario, H., Saksman, E., &amp; Tamminen, J. (2001). An adaptive Metropolis algorithm.
Bernoulli, 7(2), 223–242.
<a href="https://projecteuclid.org/euclid.bj/1080222083" class="external-link">https://projecteuclid.org/euclid.bj/1080222083</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other kernels: 
<code><a href="kernel_mirror.html">kernel_mirror</a></code>,
<code><a href="kernel_new.html">kernel_new</a>()</code>,
<code><a href="kernel_normal.html">kernel_normal</a>()</code>,
<code><a href="kernel_ram.html">kernel_ram</a>()</code>,
<code><a href="kernel_unif.html">kernel_unif</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># Update every-step and wait 1,000 steps before starting to adapt</span></span>
<span class="r-in"><span class="va">kern</span> <span class="op">&lt;-</span> <span class="fu">kernel_adapt</span><span class="op">(</span>freq <span class="op">=</span> <span class="fl">1</span>, warmup <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Two parameters model, the second parameter with a restricted range, i.e.</span></span>
<span class="r-in"><span class="co"># a lower bound of 1</span></span>
<span class="r-in"><span class="va">kern</span> <span class="op">&lt;-</span> <span class="fu">kernel_adapt</span><span class="op">(</span>lb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.xmax</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by George Vega Yon, National Cancer Institute (NCI).</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

